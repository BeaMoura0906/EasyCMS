{% extends "Base.twig" %}

{% block main %}

    <div class="container-fluid text-center">

        <div class="row">
            <div class="col-12 h2 p-5">
                Interface d'édition
            </div>
        </div>

        <div class="row">
            
            <div class="col-4">
                <div class="card m-2">
                    <div class="card-body bg-primary-subtle" style="width: ">
                        <h5><a class="link-dark link-underline-opacity-0 link-underline-opacity-75-hover" href="index.php?controller=edit&action=editPage">Éditer les pages</a></h5>
                    </div>
                </div>
            </div>
            
            <div class="col-4">
                <div class="card m-2">
                    <div class="card-body bg-primary-subtle">
                        <h5><a class="link-dark link-underline-opacity-0 link-underline-opacity-75-hover" href="">Éditer les contenus</a></h5>
                    </div>
                </div>
            </div>
            
            <div class="col-4">
                <div class="card m-2">
                    <div class="card-body bg-primary-subtle">
                        <h5><a class="link-dark link-underline-opacity-0 link-underline-opacity-75-hover" href="">Éditer la navigation</a></h5>
                    </div>
                </div>
            </div>

        </div>

        {% if listPages is defined %}
        
            <div class="row text-start mt-3">
                <div class="col-4 p-2">
                    <h5 class="p-2">Selectionnez la page à modifier</h5>
                    <ul class="list-group">
                        {% for page in listPages %}
                            <li class="list-group-item"><a class="link-dark link-underline-opacity-0 link-underline-opacity-75-hover" href="index.php?controller=edit&action=updatePage&pageId={{ page.getId }}">{{ page.getPageName }}</a></li>
                        {% endfor %}
                        <li class="list-group-item bg-body-tertiary"><a class="link-dark link-underline-opacity-0 link-underline-opacity-75-hover" href="index.php?controller=edit&action=createPage">Créer une nouvelle page</a></li>
                    </ul>
                </div>

                {% if selectedPage is defined %}
                    <div class="col-6 p-2">
                        <h5 class="p-2">Modifier {{ selectedPage.getPageName }}</h5>
                        {% if message is defined %}                        
                        <div class="alert alert-{{ message.type }} alert-dismissible fade show" role="alert">
                            {{ message.message }}
                        </div>                        
                        {% endif %}
                        <form class="row ps-2 g-3 needs-validation" action="index.php" method="post" novalidate>
                        {% if selectedPage.getId is defined %}
                            {% set action = 'updatePageValid' %}
                            <input type="hidden" value="{{ selectedPage.getId }}" name="id">
                        {% endif %}
                        <input type="hidden" value="edit" name="controller">
                        <input type="hidden" value="{{ action }}" name="action">
                        <div class="col-md-6">
                            <label for="pageNameId" class="form-label">Nom de la page</label>
                            <input type="text" class="form-control" id="pageNameId" name="pageName" value="{{ selectedPage.getPageName }}" required>
                            <div class="valid-feedback">
                            Looks good!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="isHomePageId" class="form-label">Page d'accueil</label>
                            <select class="form-select" id="isHomePageId" name="stringIsHomePage" required>
                                <option selected>{% if selectedPage.getIsHomePage == 1 %}Oui{% else %}Non{% endif %}</option>
                                {% if selectedPage.getIsHomePage == 1 %}
                                    <option>Non</option>
                                {% else %}
                                    <option>Oui</option>
                                {% endif %}
                            </select>
                            <div class="invalid-feedback">
                            Please select a valid response.
                            </div>
                        </div>
                        <div class="col-12">
                            <p class="text-secondary">Page créée le {{ selectedPage.getCreationDate }}</p>
                            <p class="text-secondary">Dernière modification le {{ selectedPage.getModificationDate }} par l'utilisateur {{ selectedPage.getIdUser }}</p>
                            {% if selectedPage.getIsPublished == 1 %}
                                <p class="text-success">Page publiée</p>
                            {% else %}
                                <p class="text-danger">Page non publiée</p>
                            {% endif %}
                            
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="toPublishId" name="toPublish">
                                <label class="form-check-label" for="toPublishId">
                                    Publier la page modifiée
                                </label>
                            </div>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-secondary" type="submit">Modifier</button>
                        </div>
                        </form>  
                    </div>
                {% endif %}

                {% if createPage is defined %}
                    <div class="col-6 p-2">
                        <h5 class="p-2">Créer une nouvelle page</h5>
                        {% if message is defined %}                        
                        <div class="alert alert-{{ message.type }} alert-dismissible fade show" role="alert">
                            {{ message.message }}
                        </div>
                        {% endif %}
                        <form class="row ps-2 g-3 needs-validation" action="index.php" method="post" novalidate>
                        {% set action = 'createPageValid' %}
                        <input type="hidden" value="edit" name="controller">
                        <input type="hidden" value="{{ action }}" name="action">
                        <div class="col-md-6">
                            <label for="pageNameId" class="form-label">Nom de la page</label>
                            <input type="text" class="form-control" id="pageNameId" name="pageName" value="" required>
                            <div class="valid-feedback">
                            Looks good!
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="isHomePageId" class="form-label">Page d'accueil</label>
                            <select class="form-select" id="isHomePageId" name="stringIsHomePage" required>
                                <option selected>Non</option>
                                <option>Oui</option>
                            </select>
                            <div class="invalid-feedback">
                            Please select a valid response.
                            </div>
                        </div>
                        <div class="col-12">                           
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="toPublishId" name="toPublish">
                                <label class="form-check-label" for="toPublishId">
                                    Publier la page créée
                                </label>
                            </div>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-secondary" type="submit">Créer</button>
                        </div>
                        </form>  
                    </div>
                {% endif %}
                

            </div>

        {% endif %}

    </div>    


{% endblock %}
